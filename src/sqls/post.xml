<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="postwrite">

	<insert id="setpost" parameterType="PostDto">
		INSERT INTO POST
		(POST_SEQ,USER_SEQ,CAMERA_SEQ,POST_CONTENT,POST_WDATE,POST_FILEPATH,POST_READCOUNT,POST_POSITION_NAME)
		VALUES(POST_SEQ.NEXTVAL,#{user_seq},#{camera_seq},#{post_content},#{sysdate},#{post_filepath},#{post_readcount},#{post_position_name})
	</insert>
	<insert id="setHashTagName" parameterType="PostHashTagInfoDto">
		INSERT INTO
		POST_HASHTAG (TAG_SEQ,HASHTAG)
		VALUES(TAG_SEQ.NEXTVAL,#{hashtag})
	</insert>
	<insert id="setmap" parameterType="PostLocationDto">
		INSERT INTO POST_LOCATION
		(POST_SEQ,LATITUDE,LONGITUDE)
		VALUES(#{post_seq},#{latitude},#{longitude})
	</insert>
	<select id="getHashTagName" parameterType="PostDto"
		resultType="PostHashTagInfoDto">
		SELECT IH.TAG_SEQ, IH.HASHTAG, PH.POST_SEQ
		FROM INFO_HASHTAG IH, POST_HASHTAG PH
		WHERE IH.TAG_SEQ = PH.TAG_SEQ
		AND PH.POST_SEQ = #{post_seq}
	</select>
	<select id="getCamera" parameterType="PostDto"
		resultType="MyPageCameraDto">
		SELECT CAMERA_SERIAL, CAMERA_IMAGE
		FROM INFO_CAMERA
		WHERE
		CAMERA_SEQ IN
		(SELECT CAMERA_SEQ
		FROM MEMBER_MYPAGE_CAMERA
		WHERE USER_SEQ
		= #{user_seq})
	</select>
</mapper>

