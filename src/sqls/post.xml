<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="postwrite">

	<insert id="setpost" parameterType="PostDto">
		INSERT INTO POST
		(POST_SEQ,USER_SEQ,CAMERA_SEQ,POST_CONTENT,POST_WDATE,POST_FILEPATH,POST_READCOUNT,POST_POSITION_NAME)
		VALUES(POST_SEQ.NEXTVAL,USER_SEQ.NEXTVAL,CAMERA_SEQ.NEXTVAL,#{post_content},SYSDATE,#{post_filepath},#{post_readcount},#{post_position_name})
	</insert>
	<insert id="setHashTagParam" parameterType="PostHashTagDto">
		INSERT INTO POST_HASHTAG (POST_SEQ,TAG_SEQ)
		VALUES(POST_SEQ.NEXTVAL,TAG_SEQ.NEXTVAL)
	</insert>
	<insert id="setHashTagName" parameterType="PostHashTagInfoDto">
		INSERT INTO POST_HASHTAG (TAG_SEQ,HASHTAG)
		VALUES(TAG_SEQ.NEXTVAL,#{hashtag})
	</insert>
	<insert id="setmap" parameterType="PostLocationDto">
		INSERT INTO POST_LOCATION (POST_SEQ,LATITUDE,LONGITUDE)
		VALUES(POST_SEQ.NEXTVAL,#{latitude},#{longitude})
	</insert>
	<select id="getHashTagName" parameterType="PostHashTagDto"
		resultType="PostHashTagInfoDto">
		SELECT HASHTAG 
		FROM INFO_HASHTAG
		WHERE TAG_SEQ = 1
	</select>
	<select id="getCamera" parameterType="PostDto"
		resultType="MyPageCameraDto">
		SELECT CAMERA_SERIAL, CAMERA_IMAGE
		FROM INFO_CAMERA
		WHERE CAMERA_SEQ IN
		(SELECT CAMERA_SEQ
		FROM MEMBER_MYPAGE_CAMERA
		WHERE USER_SEQ = #{user_seq})
	</select>
</mapper>

