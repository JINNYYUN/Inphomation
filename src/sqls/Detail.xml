<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="Detail">

<insert id="addBookmark" parameterType="bit.com.inpho.dto.DetailBookmarkDto">
	INSERT INTO POST_BOOKMARK
	VALUES(#{post_seq}, #{user_seq})
</insert>

<select id="countBookmark" parameterType="bit.com.inpho.dto.DetailBookmarkDto" resultType="java.lang.Integer">
	SELECT NVL(COUNT(*),0)
	FROM POST_BOOKMARK
	WHERE USER_SEQ = #{user_seq}
	AND POST_SEQ = #{post_seq}
</select>

<delete id="deleteBookmark" parameterType="bit.com.inpho.dto.DetailBookmarkDto">
	DELETE FROM POST_BOOKMARK
	WHERE USER_SEQ = #{user_seq}
	AND POST_SEQ = #{post_seq}
</delete>



<insert id="addLike" parameterType="bit.com.inpho.dto.DetailBookmarkDto">
	INSERT INTO POST_LIKE
	VALUES(#{post_seq}, #{user_seq}, SYSDATE)
</insert>

<select id="countLike" parameterType="bit.com.inpho.dto.DetailBookmarkDto" resultType="java.lang.Integer">
	SELECT NVL(COUNT(*),0)
	FROM POST_LIKE
	WHERE USER_SEQ = #{user_seq}
	AND POST_SEQ = #{post_seq}
</select>

<delete id="deleteLike" parameterType="bit.com.inpho.dto.DetailBookmarkDto">
	DELETE FROM POST_LIKE
	WHERE USER_SEQ = #{user_seq}
	AND POST_SEQ = #{post_seq}
</delete>

<select id="countLikeAll" parameterType="java.lang.Integer" resultType="java.lang.Integer">
	SELECT NVL(COUNT(*),0)
	FROM POST_LIKE
	WHERE POST_SEQ = #{post_seq}
</select>




<insert id="addReply" parameterType="bit.com.inpho.dto.DetailReplyDto">
	INSERT INTO POST_REPLY
	VALUES(#{post_seq}, #{user_seq}, #{reply_content}, SYSDATE)
</insert>

<select id="replyList" parameterType="bit.com.inpho.dto.DetailReplyDto"
			resultType="bit.com.inpho.dto.DetailReplyDto">
	SELECT PR.REPLY_CONTENT, PR.REPLY_DATE, B.USER_NICKNAME
	FROM POST_REPLY PR, MEMBER B
	WHERE PR.USER_SEQ = B.USER_SEQ
	AND POST_SEQ=#{post_seq}	
	ORDER BY REPLY_DATE DESC
</select>

</mapper>










